---
layout: post
title: JDK 19 Security Enhancements
---

[JDK 19](https://openjdk.java.net/projects/jdk/19/) was released on September 20, 2022! As with
my previous [blogs](https://seanjmullan.org/blog/), I
have compiled a list of what I think are the most interesting and useful
security enhancements in this release.  I have also grouped
them into appropriate categories (crypto, PKI, etc) which should make
it easier to find out what has changed in each specific area.
The [JDK 19 release notes](https://jdk.java.net/19/release-notes)
also contain further details on these and other enhancements.

Highlights of this release include further improvements that strengthen
the default security of the Java Platform and improved TLS performance.
There are also several other really useful enhancements such as adding
KeyStore support for accessing local machine certificates on Windows
and support for TLS channel binding tokens with HTTPS and Kerberos.

## Table of Contents
1. [Crypto](#crypto)
2. [PKI](#pki)
3. [TLS](#tls)
4. [Tools](#tools)
5. [Networking](#networking)

### Crypto

-   __Default key sizes increased__

    The default sizes for keys generated by JDK implementations of
    `KeyPairGenerator` and `KeyGenerator` have been increased as follows:

    - For the "RSA", "RSASSA-PSS", and "DH" algorithms, the default size has
      been increased from 2048 bits to 3072 bits
    - For the "EC" algorithm, the default size has been increased from 256
      bits to 384 bits
    - For the "AES" algorithm, the default size has been increased from 128
      bits to 256 bits (if permitted by crypto policy), otherwise the default
      falls back to 128 bits

    Issue: [JDK-8267319](https://bugs.openjdk.org/browse/JDK-8267319)

-   __SHA3 performance increased up to 2x__

    The JDK "SUN" provider SHA3 message digest algorithm performance has
    been increased up to 2x.

    Issue: [JDK-8275914](https://bugs.openjdk.org/browse/JDK-8275914)

-   __OAEPParameterSpec.DEFAULT is deprecated__

    The [`DEFAULT`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/crypto/spec/OAEPParameterSpec.html#DEFAULT)
    static field of the `javax.crypto.spec.OAEPParameterSpec` class has been
    deprecated.  This constant uses default algorithms such as SHA-1 that have
    weakened. Applications should avoid using this constant and explicitly
    specify the parameters using the [`OAEPParameterSpec(String, String, AlgorithmParameterSpec, PSource)`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/crypto/spec/OAEPParameterSpec.html#%3Cinit%3E(java.lang.String,java.lang.String,java.security.spec.AlgorithmParameterSpec,javax.crypto.spec.PSource)) constructor.

    Issue: [JDK-8284553](https://bugs.openjdk.org/browse/JDK-8284553)

-   __PSSParameterSpec(int) and PSSParameterSpec.DEFAULT are deprecated__

    The [`PSSParameterSpec(int)`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/security/spec/PSSParameterSpec.html#%3Cinit%3E(int))
    constructor and [`DEFAULT`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/security/spec/PSSParameterSpec.html#DEFAULT) static field have been deprecated. This constructor and constant uses SHA-1 as the
    default hash algorithm which has weakened and is no longer recommended.
    Applications should avoid using this constructor or constant and explicitly
    specify the parameters using the
    [`PSSParameterSpec(String, String, AlgorithmParameterSpec, int, int)`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/security/spec/PSSParameterSpec.html#%3Cinit%3E(java.lang.String,java.lang.String,java.security.spec.AlgorithmParameterSpec,int,int)) constructor.

### PKI

-   __New Windows KeyStore types for accessing local machine certificates__

    Two additional `KeyStore` types have been added,
    "Windows-MY-LOCALMACHINE" and "Windows-ROOT-LOCALMACHINE", which provide
    access to keys and certificates stored on the Windows Operating
    System that are available to *all* accounts.

    The other Windows `KeyStore` types, "Windows-MY" and "Windows-ROOT" 
    provide access to keys and certificates associated with the
    *current user's* account only. To avoid confusion, new names for these types
    have also been introduced, "Windows-MY-CURRENTUSER" and
    "Windows-ROOT-CURRENTUSER" which map to "Windows-MY" and "Windows-ROOT",
    respectively.

    The new `KeyStore` types are documented in the
    [SunMSCAPI Provider section](https://docs.oracle.com/en/java/javase/19/security/oracle-providers.html#GUID-4F1737D6-1569-4340-B140-678C70E63CD5)
    of the JDK Providers Guide.

    Issue: [JDK-6782021](https://bugs.openjdk.org/browse/JDK-6782021)

-   __Enhanced support for OtherNames in X.509 certificates__

    The JDK implementation of the [`getSubjectAlternativeNames`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/security/cert/X509Certificate.html#getSubjectAlternativeNames())
    and the [`getIssuerAlternativeNames`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/security/cert/X509Certificate.html#getIssuerAlternativeNames())
    methods of the `X509Certificate` API have been enhanced to return more
    useful information for OtherName types. The returned list now has a 3rd
    and 4th entry which contain the OID (as a String) and the
    ASN.1 encoded value (as a String if it is a character string, otherwise a
    byte array). These additional values can help applications to more
    easily identify what type the OtherName is, and avoid additional parsing
    of the encoded value to determine the OID and value.

    Issue: [JDK-8277976](https://bugs.openjdk.org/browse/JDK-8277976)

### TLS

-   __TLS performance related improvements__

    Several performance related improvements have been made which speedup 
    and reduce the amount of memory used during a TLS handshake. See the
    following issues for more details:

    - [Cache certificates decoded from TLS session tickets](https://bugs.openjdk.org/browse/JDK-8286433)
    - [Avoid evaluating SSLAlgorithmConstraints twice](https://bugs.openjdk.org/browse/JDK-8284694)
    - [Cache the results of constraint checks](https://bugs.openjdk.org/browse/JDK-8285398)

-   __3DES suites removed from default enabled TLS cipher suites__

    3DES cipher suites have been removed from the default enabled TLS cipher
    suites. Note that these cipher suites were *already disabled* since "3DES"
    is included in the `jdk.tls.disabledAlgorithms` security property and by
    default the suites will not be considered for a TLS connection handshake.

    This change makes it much harder to enable 3DES cipher suites either
    accidentally or maliciously. Per RFC 7525, implementations SHOULD NOT
    negotiate cipher suites that use algorithms offering less than 128 bits
    of security. The strength of 3DES is 112 bits, which is less than
    128 bits of security.

    We don't recommend re-enabling the suites, but the
    [release note](https://jdk.java.net/19/release-notes#JDK-8163327) contains
    instructions for doing that, if necessary.

    Issue: [JDK-8163327](https://bugs.openjdk.org/browse/JDK-8163327)

-   __New APIs for customizing TLS and DTLS signature schemes__

    Two new APIs have been added which allow applications to customize
    and retrieve the prioritized list of signature schemes used when
    negotiating a TLS or DTLS connection:
    [`javax.net.ssl.SSLParameters::setSignatureSchemes`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLParameters.html#setSignatureSchemes(java.lang.String[])) and
    [`javax.net.ssl.SSLParameters::getSignatureSchemes`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLParameters.html#getSignatureSchemes()).

    Issue: [JDK-8280494](https://bugs.openjdk.org/browse/JDK-8280494)

-   __RFC 6125 endpoint identification algorithm fully supported__

    [RFC 6125](https://www.rfc-editor.org/rfc/rfc6125) defines procedures
    for verifying identities in TLS certificates. The JDK implementation
    was mostly compliant except for one case which has now been corrected:
    the implementation will not attempt to match wildcard domains in TLS
    certificates where the wildcard character comprises a label other than
    the left-most label (ex: we won't match "foo.*.example.net").

    If necessary, applications can workaround this restriction by implementing
    their own `HostnameVerifier` or `TrustManager`.

    Issue: [JDK-7192189](https://bugs.openjdk.org/browse/JDK-7192189)

-   __New SSLException constructors that take cause as a parameter__

    New constructors have been added to the
    [`SSLHandshakeException`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLHandshakeException.html#%3Cinit%3E(java.lang.String,java.lang.Throwable)),
    [`SSLKeyException`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLKeyException.html#%3Cinit%3E(java.lang.String,java.lang.Throwable)),
    [`SSLPeerUnverifiedException`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLPeerUnverifiedException.html#%3Cinit%3E(java.lang.String,java.lang.Throwable)), and
    [`SSLProtocolException`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/javax/net/ssl/SSLProtocolException.html#%3Cinit%3E(java.lang.String,java.lang.Throwable)) APIs that take a cause
    (`Throwable`) as a parameter. This provides a more convenient option
    than having to separately call the `initCause` method.

    Issue: [JDK-8282723](https://bugs.openjdk.org/browse/JDK-8282723)

### Tools

-   __Default digest and signature algorithms strengthened for jarsigner__

    The default digest and signature algorithms used by `jarsigner` when
    signing JAR files have been strengthened.

    The default digest algorithm has been changed from SHA-256 to SHA-384.

    The default signature algorithm for RSA and RSASSA-PSS keys greater than
    or equal to 624 bits has been changed from SHA256withRSA to SHA384withRSA,
    except for keys greater than 7680 bits where SHA512withRSA is used.
    Similarly, the default signature algorithm for EC keys has been changed
    from SHA256withECDSA to SHA384withECDSA, except for keys greater than or
    equal to 512 bits where SHA512withECDSA is used.

    Here is the complete table of signature algorithm defaults from
    the [`jarsigner` tool specification](https://docs.oracle.com/en/java/javase/19/docs/specs/man/jarsigner.html):

    ![Default Signature Algorithms](/images/DefaultSignatureAlgorithms.jpg)

    Issue: [JDK-8267319](https://bugs.openjdk.org/browse/JDK-8267319)

-   __RC2 and RC4 added to jdk.security.legacyAlgorithms security property__

    "RC2" and "ARCFOUR" (RC4) have been added to the 
    `jdk.security.legacyAlgorithms` security property in the `java.security`
    configuration file. Keys using these algorithms are no longer recommended.

    `keytool` will now emit warnings if keys of this algorithm are used in any
    commands associated with secret key entries of a keystore. Here is an
    example:

    ---
        $ keytool -genseckey -keyalg RC2 -keysize 128 -keystore keystore
        Enter keystore password:  
        Generated 128-bit RC2 secret key

        Warning:
        The generated secret key uses the RC2 algorithm which is considered a security risk.

    ---

    Issue: [JDK-8286090](https://bugs.openjdk.org/browse/JDK-8286090)

-   __DES, DESede, and MD5 added to jdk.security.legacyAlgorithms security property__

    "DES", "DESede" (3DES) and "MD5" have been added to the 
    `jdk.security.legacyAlgorithms` security property in the `java.security`
    configuration file. Keys using these algorithms are no longer recommended.

    `keytool` will now emit warnings if keys or certificates use any of
    these algorithms. Here is an example:

    ---
        $ keytool -genseckey -keyalg DES -keystore keystore
        Enter keystore password:
        Generated 56-bit DES secret key

        Warning:
        The generated secret key uses the DES algorithm which is considered a security risk.

    ---

    Issue: [JDK-8255552](https://bugs.openjdk.org/browse/JDK-8255552)

-   __New jarsigner -providerPath option__

    A new `-providerPath` option has been added to the `jarsigner` tool. This
    option allows the user to specify the class path of an alternate keystore
    implementation and can be used in conjunction with the `-providerClass`
    option. Here is an example:

    ---
        $ jarsigner -keystore keystore -storetype MYKS -providerPath mods/test.myks \
          -providerClass org.test.MyProvider signed.jar mykey
        Enter keystore password:  
        jar signed.

    ---

    Issue: [JDK-8281175](https://bugs.openjdk.org/browse/JDK-8281175)

-   __New Kerberos ktab options for providing salt values__

    Two new options have been added to the Windows `ktab` tool to allow users to
    provide alternate salt values when using the `-a` option to generate keys.
    These salt values are used instead of using the default salt which is
    a concatenation of the realm and username. The `-s <salt>` option allows the
    user to provide their own salt, and the `-f` option will fetch the salt
    from the KDC. These options are useful if the KDC uses a different salt
    value, or the user simply wants to use a different salt value.

    Issue: [JDK-8279064](https://bugs.openjdk.org/browse/JDK-8279064)

### Networking

Two other important JDK 19 security related enhancements in the networking
area that provide significant security benefits and are worth mentioning are:

-   __HTTPS Channel Binding support for Java GSS/Kerberos__

    This enhancement adds support for TLS channel binding for Negotiate/Kerberos
    authentication over HTTPS through `javax.net.HttpsURLConnection`.

    A new system property named
    [`jdk.https.negotiate.cbt`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/net/doc-files/net-properties.html#jdk.https.negotiate.cbt) has
    been introduced to allow users to configure how channel binding tokens
    are used by `HttpsURLConnection`.
  
    See the [release note](https://jdk.java.net/19/release-notes#JDK-8279842)
    for more details.

    Issue: [JDK-8279842](https://bugs.openjdk.org/browse/JDK-8279842)

-   __Disable http DIGEST mechanism with MD5 and SHA-1 by default__

    The MD5 and SHA-1 HTTP DIGEST mechanisms have been disabled by default.
    These algorithms have weaknesses and are no longer recommended.

    A new system property named [`http.auth.digest.reEnabledAlgorithms`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/net/doc-files/net-properties.html#http.auth.digest.reEnabledAlgorithms)
    has been introduced which can be used to re-enable these mechanisms, if
    necessary, and at your own risk.

    Issue: [JDK-8281561](https://bugs.openjdk.org/browse/JDK-8281561)
