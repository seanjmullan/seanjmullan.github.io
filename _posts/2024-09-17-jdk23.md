---
layout: post
title: JDK 23 Security Enhancements
---

[JDK 23](https://openjdk.java.net/projects/jdk/23/) was released on September 17, 2024!
As with my previous [blogs](https://seanjmullan.org/blog/), I
have compiled a list of what I think are the most interesting and useful
security enhancements in this release.  I have also grouped
them into appropriate categories (crypto, PKI, etc) which should make
it easier to find out what has changed in each specific area.
The [JDK 23 release notes](https://jdk.java.net/23/release-notes)
also contain further details on these and other enhancements.

Highlights of this release include new "thread" and "timestamp" 
debugging options and crypto related performance improvements.

Also, one other important JDK 23 feature that is not part of the security
libraries area but is worth mentioning is:

-   [JEP 471](https://openjdk.org/jeps/471): Deprecate the Memory-Access Methods in sun.misc.Unsafe for Removal

    This JEP deprecates the memory-access methods in sun.misc.Unsafe for
    removal in a future release. Quoting from the JEP:
    "Removing the memory-access methods in sun.misc.Unsafe is part of a
    long-term coordinated effort to ensure that the Java Platform has
    [integrity by default](https://openjdk.org/jeps/8305968).

## Table of Contents
1. [Crypto](#crypto)
2. [PKI](#pki)
3. [Authorization][#authorization]
4. [Kerberos](#kerberos)
5. [Miscellaneous](#miscellaneous)


### Crypto

-   __Increased CipherInputStream buffer size__

    The buffer size of [`javax.crypto.CipherInputStream`](https://docs.oracle.com/en/java/javase/23/docs/api/java.base/javax/crypto/CipherInputStream.html)
    has been increased from 512 bytes to 8192 bytes. This change can improve
    performance and is more consistent with buffer sizes for other APIs such as
    `java.io.FileInputStream`.

    Issue: [JDK-833018](https://bugs.openjdk.org/browse/JDK-8330108)

-   __New SecureRandom() performance improved__

    The performance of constructing a SecureRandom via `new SecureRandom()`
    has been improved.  <More details>

    Issues: [JDK-8324646](https://bugs.openjdk.org/browse/JDK-8324646)
            [JDK-8324648](https://bugs.openjdk.org/browse/JDK-8324648)

-   __PKCS11__

    Native PKCS11 mechanisms which support decryption but not encryption or
    signature verification but not signing are considered legacy and are
    disabled by default. The legacy mechanism check in SunPKCS11 provider
    is enhanced with the service type. For example, prior to this fix, a
    mechanism supporting encryption, decryption, and verification but not
    signing, is considered legacy and can't be used at all. After this fix,
    the corresponding Cipher service using this mechanism is available since
    both encryption and decryption are supported. However, the corresponding
    Signature service is not since only verification is supported. To bypass
    the legacy mechanism check, set the PKCS11 provider configuration attribute 
    "allowLegacy" to true (default value: false). Note that it is the caller's
    responsibility to make sure the legacy mechanism is not used for the
    unsupported functionality, e.g. use this mechanism to sign. 

    Issue: [JDK-8293345](https://bugs.openjdk.org/browse/JDK-8293345)

### PKI

-   __New root CA certificates__

    Several new root CA certificates have been added to the `cacerts` keystore:

    - Two Certainly root CA certificates
      - [Certainly Root R1](https://crt.sh/?id=5150405959) has the following distinguished name:  
          <div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:left; text-indent:25px; padding:10px 0;">
          <code>
          CN=Certainly Root R1, O=Certainly, C=US
          </code>
          </div>
      - [Certainly Root E1](https://crt.sh/?id=5150403703) has the following distinguished name:  
          <div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:left; text-indent:25px; padding:10px 0;">
          <code>
          CN=Certainly Root E1, O=Certainly, C=US
          </code>
          </div>

      These root certificates have also been added to the `cacerts`
      keystore in Oracle's JDK 22.0.1, 21.0.3, 17.0.11, 11.0.23, 8u411, and
      7u421 releases.

      Issue: [JDK-8321408](https://bugs.openjdk.org/browse/JDK-8321408)

    - Two GlobalSign root CA certificates
      - [GlobalSign Root R46](https://crt.sh/?id=1730333109) has the following distinguished name:
        <div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:left; text-indent:25px; padding:10px 0;">
        <code>
        CN=GlobalSign Root R46, O=GlobalSign nv-sa, C=BE
        </code>
        </div>
      - [GlobalSign Root E46](https://crt.sh/?id=1730335161) has the following distinguished name:
        <div style="background-color:rgba(0, 0, 0, 0.0470588); text-align:left; text-indent:25px; padding:10px 0;">
        <code>
        CN=GlobalSign Root E46, O=GlobalSign nv-sa, C=BE
        </code>
        </div>

      These root certificates have also been added to the `cacerts`
      keystore in Oracle's JDK 22.0.2, 21.0.4, 17.0.12, 11.0.24, 8u421,
      and 7u431 releases.

      Issue: [JDK-8316138](https://bugs.openjdk.org/browse/JDK-8316138)

-   __New KeyStore for MacOS root certificates__

    A new `KeyStore` named `KeychainStore-ROOT` has been added to the Apple
    security provider. This keystore contains root certificates stored in
    the system keychain on MacOS systems. The Apple provider now supports
    two KeyStores, `KeychainStore-Root` and the existing `KeychainStore` 
    which contains private keys and certificates for the user's keychain.

    This enhancement will fix issues that caused HTTPs connections to fail
    because the JDK was unable to find a root certificate in the to
    establish trust in the peer's certificate chain. After this change,
    users should set the `javax.net.ssl.trustStoreType` system
    property to `KeychainStore-ROOT`.

    Issue: [JDK-8320362](https://bugs.openjdk.org/browse/JDK-8320362)

-   __New system property to use POST for all OCSP requests__

    JDK 17 introduced a performance enhancement whereby the JDK uses
    the HTTP GET method for small OCSP requests, and POST for all other
    requests. However, some OCSP responders do not handle GET requests
    well, and this has caused issues that can't be easily worked around.

    Thus, a new system property named `com.sun.security.ocsp.useget` has been
    introduced. When set to "false", the JDK will _only_ use the HTTP
    POST method when submitting OCSP requests. The default if not set, is
    "true" with the behavior being the same as before.

    Issue: [JDK-8328638](https://bugs.openjdk.org/browse/JDK-8328638)

### Authorization

    The `getSubject` method of `javax.security.auth.Subject` has been
    changed to throw an `UnsupportedOperationException`, unless a Security
    Manager is allowed or enabled on the command line, via `-Djava.security.manager`.

    This change was made to prepare users for a future release where this
    method will be changed to _always_ throw `UnsupportedOperationException`.
    This method is problematic because it depends on `AccessControlContext`,
    which is one of the Security Manager APIs that was deprecated for
    removal in JDK 17.

    The good news is that a replacement API (`Subject.current`) was added
    in JDK 18. Applications and libraries should strongly consider replacing
    their calls to `Subject.getSubject` with `Subject.current`.

    Issue: [JDK-8296244](https://bugs.openjdk.org/browse/JDK-8296244)

### Kerberos

-   __New security/system property to support case-sensitive principal names__

    A new security property named `jdk.security.krb5.name.case.sensitive` has
    been introduced to allow Kerberos principal names to be looked up in
    keytab and ccache files in a case-sensitive manner. Prior to this change,
    principal names were always treated as case-insensitive, meaning a
    principal name of `SEAN@ACME.ORG` would match `sean@acme.org`. However,
    some Kerberos implementations treat these principals as distinct.

    If the property is set to "true", the JDK Kerberos implementation will
    use a case-sensitive comparison when matching principal names.
    The default value of this property, if not set, is "false" to
    preserve existing behavior. A system property of the same name can
    also be used, and it will override the value of the security property.

    Issue: [JDK-8331975](https://bugs.openjdk.org/browse/JDK-8331975)

-   __Enhanced Kerberos debugging__

    Debug output of the Kerberos component is now directed to standard
    error instead of standard output. Also each message is prefixed with
    the Kerberos subcomponent that it applies to: `krb5loginmodule`,
    `jgss`, `krb5`, etc.

    Here is example output debugging code with the `sun.security.krb5.debug`
    system property set to "true":

    ---
        krb5: Java config name: null
        krb5: Native config name: /etc/krb5.conf
        krb5: Loading config file from /etc/krb5.conf
        krb5: Loaded from native config

    ---

    Issue: [JDK-8327818](https://bugs.openjdk.org/browse/JDK-8327818)

### Miscellaneous

-   __New "thread" and "timestamp" options for the java.security.debug system property__

    New "thread" and "timestamp" have been added to the 
    `java.security.debug` system property to help you debug applications.

    The "thread" option will print the thread and caller information of
    each debug statement. The "timestamp" option will print the date and
    time of each debug statement. These new options can be extremely helpful
    when debugging multi-threaded applications.

    The options can be appended with a "+" sign to a `java.security.debug`
    setting. For example, below is a portion of the output of an application
    run with `-Djava.security.debug=properties+thread+timestamp`. Each
    debug line contains a timestamp and the thread id and caller.

    ---

        properties[0x1|main|Security.java:161|2024-09-20 09:31:39.929]: java.security
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.931]: Initial security property: jdk.jar.disabledAlgorithms=MD2, MD5, RSA keySize < 1024, DSA keySize < 1024, SHA1 denyAfter 2019-01-01
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.931]: Initial security property: security.provider.13=SunPKCS11
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.931]: Initial security property: security.provider.12=Apple
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.931]: Initial security property: http.auth.digest.disabledAlgorithms=MD5, SHA-1
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.932]: Initial security property: jdk.security.legacyAlgorithms=SHA1, RSA keySize < 2048, DSA keySize < 2048, DES, DESede, MD5, RC2, ARCFOUR
        properties[0x1|main|Security.java:122|2024-09-20 09:31:39.932]: Initial security property: securerandom.source=file:/dev/random

    ---

    Issue: [JDK-8051959](https://bugs.openjdk.org/browse/JDK-8051959)
